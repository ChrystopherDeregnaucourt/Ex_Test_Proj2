<!--
  Page de détails d'un pays : on adapte l'affichage selon l'état du ViewModel
  (chargement, erreur, pays introuvable ou données disponibles).
-->
<section class="details" *ngIf="viewModel$ | async as view">
  <ng-container [ngSwitch]="view.status">
    <!-- État d'attente pendant la récupération des informations. -->
    <p class="state-message" *ngSwitchCase="'loading'" aria-live="polite">
      Loading country data...
    </p>

    <!-- Message d'erreur global lorsque l'appel de service a échoué. -->
    <p
      class="state-message state-message--error"
      *ngSwitchCase="'error'"
      role="alert"
    >
      We were unable to load the information for this country. Please try again
      later.
    </p>

    <!-- Indication utilisateur lorsque l'identifiant ne correspond à aucun pays. -->
    <div class="state-message" *ngSwitchCase="'not-found'">
      <p class="state-message__title">Country not found</p>
      <p class="state-message__body">
        The requested country does not exist in our records.
      </p>
      <a class="link" routerLink="/">Back to dashboard</a>
    </div>

    <!--
      Carte principale affichant les métriques du pays et le graphique des
      médailles lorsque les données sont disponibles.
    -->
    <div *ngSwitchCase="'ready'" class="details__card" aria-live="polite">
      <!-- Bouton de retour vers le dashboard principal. -->
      <div class="details__top-bar">
        <button type="button" class="back-button" routerLink="/">
          ← Back
        </button>
      </div>

      <header class="details__header">
        <h1 class="details__title">{{ view.countryName }}</h1>
        <!--
          Cartes affichant les indicateurs clés calculés dans le composant :
          participations, total de médailles et nombre d'athlètes.
        -->
        <div class="details__metrics" aria-label="Country statistics">
          <article class="metric">
            <span class="metric__label">Number of entries</span>
            <span class="metric__value">{{ view.metrics.entries }}</span>
          </article>
          <article class="metric">
            <span class="metric__label">Total number medals</span>
            <span class="metric__value">{{ view.metrics.medals }}</span>
          </article>
          <article class="metric">
            <span class="metric__label">Total number of athletes</span>
            <span class="metric__value">{{ view.metrics.athletes }}</span>
          </article>
        </div>
      </header>

      <!-- Graphique linéaire représentant l'évolution des médailles dans le temps. -->
      <div class="details__chart">
        <canvas
          baseChart
          aria-label="Line chart showing the total medals obtained over time"
          [type]="'line'"
          [data]="view.chartData"
          [options]="lineChartOptions"
        ></canvas>
      </div>
    </div>
  </ng-container>
</section>
